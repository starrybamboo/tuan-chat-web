# 变更提案: WebGAL 实时渲染增量更新

## 需求背景
当前实时渲染只对新增消息进行增量写入，消息顺序变更与部分渲染设置（小头像、自动立绘）不会触发实时更新，需要手动重渲染历史。希望在顺序调整、插入/删除/批量移动与非 TTS 设置变更时做到增量更新，并在不可增量时回退全量重渲染。

## 变更内容
1. 增量处理消息顺序变化，尽量复用现有行号映射重排场景文本。
2. 小头像/自动立绘开关变更后触发增量重渲染（不触发 TTS 重新生成）。
3. 无法增量处理时允许回退为全量渲染。

## 影响范围
- 模块: app/webGAL, app/components/chat/core
- 文件: app/webGAL/realtimeRenderer.ts, app/webGAL/useRealtimeRender.ts, app/components/chat/core/realtimeRenderOrchestrator.tsx
- API: 无
- 数据: 无

## 核心场景

### 需求: 增量更新实时渲染
**模块:** webgal
消息顺序/设置变更后，实时渲染能立即反映变化。

#### 场景: 消息顺序变化
用户拖拽或移动消息后
- WebGAL 场景文本按新顺序重排
- 保持不自动跳转，必要时允许回退全量渲染

#### 场景: 小头像/自动立绘设置变更
用户切换设置后
- 已渲染消息按新设置增量更新
- 不重新生成 TTS

## 风险评估
- **风险:** 行号映射缺失或不一致导致增量失败
- **缓解:** 检测失败时回退全量渲染并记录日志
